apiVersion: 1.0.0-beta1
podVersion: 0.0.1
podRuntime: podman

volumes:
    - name: nginx-files
      type: config
containers:
    - name: webserver
      image: kitematic/hello-world-nginx
      restart: on-failure
      startupProbe:
          timeout: 33
          cmd:
              - sh
              - -c
              - "wget -O /dev/null http://127.0.0.1"
      readinessProbe:
          timeout: 66
          cmd:
              - sh
              - -c
              - "wget -O /dev/null http://127.0.0.1"
      livenessProbe:
          timeout: 9
          cmd:
              - sh
              - -c
              - "wget -O /dev/null http://127.0.0.1"
      signal:
          - kill: HUP
      mounts:
          - dest: /website_files
            volume: nginx-files
      expose:
          - targetPort: 80
            hostPort: 8080
            clusterPort: ${clusterPort}
            ingress:
                - protocol: http
                  pathBeg: /
